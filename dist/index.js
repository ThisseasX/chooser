"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=require("lodash/fp"),e=/^\{(?:\$(\d+?))?(?:#(.+?))?\}$/;function t(e){return n.negate(n.isUndefined)(e)}var r=function(r){var u=r[0],i=r[1];return n.flow((function(n){return[{when:n.when,then:n.then},e.exec(i)||[]]}),(function(n){var e=n[0],t=e.when,r=e.then,u=n[1];return{when:t,then:r,ref:u[1],use:u[2]}}),n.pickBy(t))({when:u,then:i})},u=function(e){return n.isPlainObject(e)?function(e){return n.flow(n.entries,n.map(r))(e)}(e):e},i=function(e){var t=e.input,r=e.choices,i=e.equalityFn;return n.flow((function(e){return n.set("choices",function(e){return n.isFunction(e)?e():e}(e.choices),e)}),(function(e){return n.set("input",function(e,t,r){return n.isPlainObject(e)&&n.isUndefined(r)?n.toString(t):t}(e.choices,e.input,i),e)}),(function(e){return n.set("choices",u(e.choices),e)}),(function(e){return n.set("equalityFn",function(e){return e&&n.curryN(2,e)}(i),e)}),n.values)({input:t,choices:r,equalityFn:i})},o=function(e,t){return function(r){return n.flow(n.get("when"),n.cond([[n.isArray,n.some(t(e))],[n.stubTrue,t(e)]]))(r)}},c=function(e,r,u,i){return void 0===u&&(u=n.eq),n.flow(n.cond([[n.constant(t(i)),n.nth(i)],[n.stubTrue,n.find(o(e,u))]]),n.defaultTo({}),n.cond([[n.has("ref"),n.flow(n.get("ref"),n.partialRight(c,[e,r,u,n.__]))],[n.has("use"),n.flow(n.get("use"),n.partialRight(c,[n.__,r,u]))],[n.stubTrue,n.identity]]))(r)};exports.chooser=function(e,t,r){return function(u,o){return n.flow(i,n.spread(c),n.cond([[n.has("eager"),n.get("eager")],[n.stubTrue,n.result("then")]]),n.defaultTo(t))({input:u,choices:e,equalityFn:o||r})}};
//# sourceMappingURL=index.js.map
