"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("lodash/fp"),n=/^\{(?:\$(\d+?))?(?:#(.+?))?\}$/,t=function(t){return e.isPlainObject(t)?function(t){return Object.entries(t).map((function(t){var i=t[0],r=t[1],u=n.exec(r)||[],c={when:i,ref:u[1],use:u[2],then:r};return e.pickBy(e.negate(e.isUndefined),c)}),[])}(t):t},i=function(n){var i=n.input,r=n.choices,u=n.equalityFn;return e.flow((function(n){return e.set("choices",function(n){return e.isFunction(n)?n():n}(n.choices),n)}),(function(n){return e.set("input",function(n,t,i){return e.isPlainObject(n)&&e.isUndefined(i)?e.toString(t):t}(n.choices,n.input,u),n)}),(function(n){return e.set("choices",t(n.choices),n)}),(function(n){return e.set("equalityFn",function(n){return n&&e.curryN(2,n)}(u),n)}),e.values)({input:i,choices:r,equalityFn:u})},r=function(n,t,i,u){return void 0===i&&(i=e.eq),e.flow(e.isUndefined(u)?e.find((function(t){var r=t.when;return e.isArray(r)?r.some(i(n)):i(n)(r)})):e.constant(t[u]),e.defaultTo({}),(function(u){return e.isUndefined(u.ref)?e.isUndefined(u.use)?u:r(u.use,t,i):r(n,t,i,u.ref)}))(t)};exports.chooser=function(n,t,u){return function(c,o){return e.flow(e.spread(r),(function(n){return e.isUndefined(n.eager)?e.result("then",n):n.eager}),e.defaultTo(t))(i({input:c,choices:n,equalityFn:o||u}))}};
//# sourceMappingURL=index.js.map
