import{flow as n,spread as e,isUndefined as t,result as r,defaultTo as u,set as i,isFunction as c,isPlainObject as o,toString as f,pickBy as s,negate as a,curryN as h,values as p,constant as l,find as v,isArray as d,eq as m}from"lodash/fp";var q=/^\{(?:\$(\d+?))?(?:#(.+?))?\}$/,y=function(n){return o(n)?function(n){return Object.entries(n).map((function(n){var e=n[0],r=n[1],u=q.exec(r)||[],i={when:e,ref:u[1],use:u[2],then:r};return s(a(t),i)}),[])}(n):n},F=function(e){var r=e.input,u=e.choices,s=e.equalityFn;return n((function(n){return i("choices",function(n){return c(n)?n():n}(n.choices),n)}),(function(n){return i("input",function(n,e,r){return o(n)&&t(r)?f(e):e}(n.choices,n.input,s),n)}),(function(n){return i("choices",y(n.choices),n)}),(function(n){return i("equalityFn",function(n){return n&&h(2,n)}(s),n)}),p)({input:r,choices:u,equalityFn:s})},g=function(e,r,i,c){return void 0===i&&(i=m),n(t(c)?v((function(n){var t=n.when;return d(t)?t.some(i(e)):i(e)(t)})):l(r[c]),u({}),(function(n){return t(n.ref)?t(n.use)?n:g(n.use,r,i):g(e,r,i,n.ref)}))(r)};export default function(i,c,o){return function(f,s){return n(e(g),(function(n){return t(n.eager)?r("then",n):n.eager}),u(c))(F({input:f,choices:i,equalityFn:s||o}))}}
//# sourceMappingURL=index.es.js.map
