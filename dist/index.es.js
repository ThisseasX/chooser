var n=/^\{(?:\$(\d+?))?(?:#(.+?))?\}$/,e=function(e){return _.isPlainObject(e)?function(e){return Object.entries(e).map((function(e){var t=e[0],i=e[1],u=n.exec(i)||[],r={when:t,ref:u[1],use:u[2],then:i};return _.pickBy(_.negate(_.isUndefined),r)}),[])}(e):e},t=function(n){var t=n.input,i=n.choices,u=n.equalityFn;return _.flow((function(n){return _.set("choices",function(n){return _.isFunction(n)?n():n}(n.choices),n)}),(function(n){return _.set("input",function(n,e){return _.isPlainObject(n)?_.toString(e):e}(n.choices,n.input),n)}),(function(n){return _.set("choices",e(n.choices),n)}),(function(n){return _.set("equalityFn",function(n){return n&&_.curryN(2,n)}(u),n)}),_.values)({input:t,choices:i,equalityFn:u})},i=function(n,e,t,u){return void 0===t&&(t=_.eq),_.flow(_.isUndefined(u)?_.find((function(e){var i=e.when;return _.isArray(i)?i.some(t(n)):t(n)(i)})):_.constant(e[u]),_.defaultTo({}),(function(u){return _.isUndefined(u.ref)?_.isUndefined(u.use)?u:i(u.use,e,t):i(n,e,t,u.ref)}))(e)};export default function(n,e,u){return function(r,c){return _.flow(_.spread(i),(function(n){return _.isUndefined(n.eager)?_.result("then",n):n.eager}),_.defaultTo(e))(t({input:r,choices:n,equalityFn:c||u}))}}
//# sourceMappingURL=index.es.js.map
